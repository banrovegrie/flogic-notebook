\section{Math Extra}
\subsection{Seldom used combinatorics}
\begin{itemize}
  \item Fibonacci in $O(\log(N))$ with memoization is:
  $$
   f(0) = f(1) = 1$$$$
   f(2k) = f(k)^2 + f(k - 1)^2$$$$
   f(2k + 1) = f(k) \times (f(k) + 2*f(k - 1))
  $$

  \item Wilson's Theorem Extension: 
  
  $B = b_1 b_2 \ldots b_m (\mod n) = \pm 1$, all 
  $b_i \leq n$ such that $\gcd(b_i, n) = 1$. 
  
  If $n \leq 4$ or $n = (\text{odd prime})^k$ or 
  $n = 2(\text{odd prime})^k)$ then $B = -1$ for any $k$. 
  
  Else $B = 1$.
  
  \item Stirling numbers of the second kind, denoted by $S(n, k) =$ 
  number of ways to split $n$ numbers into $k$ non-empty sets.
  $$
    S(n, 1) = S(n, n) = 1$$$$
    S(n, k) = k S(n - 1, k) + S(n - 1, k - 1)
  $$
  $S(n - d + 1, k - d + 1) = S(n, k)$ where if indexes $i, j$ belong to the same set, then $|i - j| \geq d$.

    % S_r(n, k) = S(n, k) \text{ with at least r numbers in each set}\\
    % S_r(n, k) = k S_r(n - 1, k) + (n - 1) * Sr(n - r, k - 1)(r - 1) 

  \item Burnside's Lemma: $|\text{classes}| = \frac{1}{|G|} \sum_{\forall\ g \in G}(K^{C(g)})$,
  where: 
  
  $G$ = different permutations possible,


  $C(g)$ = number of cycles on the permutation $g$, 
  
  and $K$ = Number of states for each element

  \item Different ways to paint a necklace with $N$ beads and $K$ colors:
  $$G = {(1, 2, \ldots N), (2, 3, \ldots N, 1), \ldots (N, 1, \ldots N - 1)}$$ 
  $g_i = (i, i + 1, \ldots i + N)$, (taking mod N to get it right) $i = 
  1 \ldots N$ with $i$ per step, that is, $i \to 2i \to 3i \ldots$

  Cycles in $g_i$ all have size $n / \gcd(i, n)$, so $$C(g_i) = \gcd(i, n)$$
  $$ \text{ans} = \frac{1}{N} \sum_{i = 1 \ldots N} (K ^ {\gcd(i, n)})$$
  $$ \text{ans} = \frac{1}{N} \sum_{\forall\ d | N}(\phi(\frac{N}{d}) K^d)$$ 
\end{itemize}

\subsection{Combinatorial formulas}

 $$\sum_{k=0}^{n}k^{2}=n(n+1)(2n+1)/6$$
 $$\sum_{k=0}^{n}k^{3}=n^{2}(n+1)^{2}/4$$
 $$\sum_{k=0}^{n}k^{4}=(6n^{5}+15n^{4}+10n^{3}-n)/30$$
 $$\sum_{k=0}^{n}k^{5}=(2n^{6}+6n^{5}+5n^{4}-n^{2})/12$$
 $$\sum_{k=0}^{n}x^{k}=(x^{n+1}-1)/(x-1)$$
 $$\sum_{k=0}^{n}kx^{k}=(x-(n+1)x^{n+1}+nx^{n+2})/(x-1)^{2}$$
 $${n \choose k}=\frac{n!}{(n-k)!k!}$$
 $${n \choose k}={n-1 \choose k}+{n-1 \choose k-1}$$
 $${n \choose k}=\frac{n}{n-k}{n-1 \choose k}$$
 $${n \choose k}=\frac{n-k+1}{k}{n \choose k-1}$$
 $${n+1 \choose k}=\frac{n+1}{n-k+1}{n \choose k}$$
 $${n \choose k+1}=\frac{n-k}{k+1}{n \choose k}$$
 $$\sum_{k=1}^{n}k\tbinom{n}{k}=n2^{n-1}$$
 $$\sum_{k=1}^{n}k^{2}\tbinom{n}{k}=(n+n^{2})2^{n-2}$$
 $${m+n \choose r}=\sum_{k=0}^{r}{m \choose k}{n \choose r-k}$$
 $${n \choose k}=\prod_{i=1}^{k}\frac{n-k+i}{i}$$


\subsection{Number theory identities}
\textbf{Lucas' Theorem:} For non-negative integers $m$ and $n$ and a prime $p$,

$$\binom{m}{n}\equiv\prod_{i=0}^k\binom{m_i}{n_i}\pmod p,$$
where
$$m=m_kp^k+m_{k-1}p^{k-1}+\cdots +m_1p+m_0$$
is the base $p$ representation of $m$, and similarly for $n$.

\subsection{Stirling Numbers of the second kind}
Number of ways to partition a set of $n$ numbers into $k$ non-empty subsets.

$${n \brace k}=\frac{1}{k!}\sum_{j=0}^{k}(-1)^{(k-j)}{k \choose j}j^n$$

Recurrence relation:

  $${0 \brace 0}=1$$
  $${n \brace 0}={0 \brace n}=1$$
  $${n+1 \brace k}=k{n \brace k}+{n \brace k-1}$$


\subsection{Burnside's Lemma}
Let $G$ be a finite group that acts on a set $X$. For each $g$ in $G$ let $X^g$ denote the set of elements in $X$ that are fixed by $g$, which means $X^g=\{x\in X| g(x)=x\}$. Burnside's lemma assers the following formula for the number of orbits, denoted $|X/G|$:
\begin{align*}
|X/G|=\frac{1}{|G|} \sum_{g\in G} |X^g|
\end{align*}

\subsection{Numerical integration}
RK4: to integrate $\dot{y} = f(t, y)$ with $y_0 = y(t_0)$, compute
\begin{align*}
  k_1 &= f(t_n, y_n) \\
  k_2 &= f(t_n + \frac h 2, y_n + \frac h 2 k_1) \\
  k_3 &= f(t_n + \frac h 2, y_n + \frac h 2 k_2) \\
  k_4 &= f(t_n + h, y_n + h k_3) \\
  y_{n+1} &= y_n + \frac h 6 (k_1 + 2k_2 + 2k_3 + k_4) 
\end{align*}
